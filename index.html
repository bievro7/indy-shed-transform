<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Property Transformation - Indy Shed Company</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { 
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #2c5aa0 0%, #1a3a6b 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 { font-size: 26px; margin-bottom: 8px; }
        .header .tagline { font-size: 15px; opacity: 0.95; }
        
        .step { display: none; padding: 30px; }
        .step.active { display: block; }
        
        .step-indicator {
            display: flex;
            justify-content: center;
            padding: 25px;
            background: #f8f9fa;
            gap: 20px;
            flex-wrap: wrap;
        }
        .step-dot {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #999;
            transition: all 0.3s;
            font-size: 18px;
        }
        .step-dot.active { background: #2c5aa0; color: white; transform: scale(1.15); }
        .step-dot.completed { background: #28a745; color: white; }
        
        .selection-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        .selection-card {
            border: 3px solid #e0e0e0;
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        .selection-card:hover { border-color: #2c5aa0; transform: translateY(-5px); }
        .selection-card.selected { border-color: #2c5aa0; background: #e8f4f8; }
        .selection-card .icon { font-size: 48px; margin-bottom: 15px; }
        .selection-card .title { font-size: 22px; font-weight: bold; color: #2c5aa0; margin-bottom: 10px; }
        .selection-card .badge {
            position: absolute;
            top: -12px;
            right: 15px;
            background: #28a745;
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .upload-area {
            border: 3px dashed #2c5aa0;
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: #f8f9fa;
            margin: 20px 0;
        }
        .upload-area:hover { background: #e9ecef; }
        .upload-icon { font-size: 56px; margin-bottom: 15px; }
        .preview-image { max-width: 100%; max-height: 300px; border-radius: 8px; margin: 20px 0; }
        
        .form-group { margin-bottom: 22px; }
        .form-group label { display: block; font-weight: 600; margin-bottom: 10px; color: #333; }
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 14px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
        }
        
        .package-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 18px;
            margin: 20px 0;
        }
        .package-card {
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 22px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }
        .package-card:hover { border-color: #2c5aa0; transform: translateY(-3px); }
        .package-card.selected { border-color: #2c5aa0; background: #e8f4f8; border-width: 3px; }
        .package-card .name { font-size: 20px; font-weight: bold; color: #2c5aa0; margin-bottom: 12px; }
        .package-card .price { font-size: 26px; font-weight: bold; margin-bottom: 12px; }
        
        .btn {
            padding: 16px 35px;
            border: none;
            border-radius: 8px;
            font-size: 17px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            background: linear-gradient(135deg, #2c5aa0 0%, #1a3a6b 100%);
            color: white;
        }
        .btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 6px 16px rgba(44, 90, 160, 0.4); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        
        .btn-secondary {
            background: white;
            color: #2c5aa0;
            border: 2px solid #2c5aa0;
        }
        
        .btn-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 25px;
        }
        
        .loading {
            text-align: center;
            padding: 50px 30px;
        }
        .loading-spinner {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #2c5aa0;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 0 auto 25px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        .results-grid { display: grid; gap: 25px; margin: 25px 0; }
        .result-item {
            background: #f8f9fa;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .result-item .result-header {
            background: #2c5aa0;
            color: white;
            padding: 15px 20px;
            font-size: 18px;
            font-weight: bold;
        }
        .result-item .content { padding: 20px; }
        .result-item img { width: 100%; border-radius: 8px; margin-bottom: 15px; }
        
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        .comparison-item h4 {
            background: #2c5aa0;
            color: white;
            padding: 10px;
            border-radius: 8px 8px 0 0;
            margin: 0;
            font-size: 14px;
        }
        .comparison-item.after h4 { background: #28a745; }
        
        .quote-summary {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin: 25px 0;
        }
        .quote-line {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #e0e0e0;
        }
        .quote-line.total {
            font-size: 18px;
            font-weight: bold;
            border-top: 3px solid #2c5aa0;
            padding-top: 15px;
            margin-top: 10px;
        }
        .quote-line.savings { color: #28a745; font-weight: bold; }
        
        .quote-total {
            background: linear-gradient(135deg, #2c5aa0 0%, #1a3a6b 100%);
            color: white;
            padding: 30px;
            text-align: center;
            border-radius: 12px;
            margin-top: 20px;
        }
        .quote-total .amount { font-size: 48px; font-weight: bold; margin: 15px 0; }
        
        .alert { padding: 18px; border-radius: 10px; margin: 20px 0; }
        .alert-success { background: #d1e7dd; border: 1px solid #a3cfbb; color: #0f5132; }
        
        @media (max-width: 768px) {
            .comparison { grid-template-columns: 1fr; }
            .package-cards, .selection-cards { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè° Complete Property Transformation System</h1>
            <p class="tagline">Transform Your Garage, Yard, and Storage in Minutes</p>
        </div>
        
        <div class="step-indicator" id="stepIndicator">
            <div class="step-dot active" data-step="1">1</div>
            <div class="step-dot" data-step="2">2</div>
            <div class="step-dot" data-step="3">3</div>
            <div class="step-dot" data-step="4">4</div>
            <div class="step-dot" data-step="5">5</div>
        </div>
        
        <!-- STEP 1: What do you need? -->
        <div class="step active" id="step1">
            <h2 style="margin-bottom: 25px; color: #2c5aa0;">Step 1: What's Your Storage Problem?</h2>
            
            <div class="selection-cards">
                <div class="selection-card" onclick="selectNeed('garage')">
                    <div class="icon">üöó</div>
                    <div class="title">Garage Only</div>
                    <p style="color: #666; margin-top: 10px;">Organize your cluttered garage with custom shelving</p>
                </div>
                
                <div class="selection-card" onclick="selectNeed('shed')">
                    <div class="icon">üè†</div>
                    <div class="title">Shed Only</div>
                    <p style="color: #666; margin-top: 10px;">New shed with organized interior storage</p>
                </div>
                
                <div class="selection-card" style="position: relative;" onclick="selectNeed('both')">
                    <div class="badge">SAVE $500</div>
                    <div class="icon">‚ú®</div>
                    <div class="title">Complete Solution</div>
                    <p style="color: #666; margin-top: 10px;">Garage + shed - the ultimate transformation</p>
                </div>
            </div>
            
            <div class="alert alert-success" style="display: none;" id="needSelected">
                <strong>Selected:</strong> <span id="needText"></span>
            </div>
            
            <button class="btn" id="step1Next" disabled onclick="goToStep(2)">Continue to Photos</button>
        </div>
        
        <!-- STEP 2: Upload Photos -->
        <div class="step" id="step2">
            <h2 style="margin-bottom: 25px; color: #2c5aa0;">Step 2: Upload Your Photos</h2>
            
            <div id="garagePhotoSection" style="display: none;">
                <h3 style="margin-bottom: 15px;">üì∏ Garage Photo</h3>
                <div class="upload-area" id="garageUploadArea" onclick="document.getElementById('garageInput').click()">
                    <div class="upload-icon">üì∏</div>
                    <h3>Take Garage Photo</h3>
                    <p style="color: #666; margin-top: 10px;">Stand in doorway, capture full view</p>
                </div>
                <input type="file" id="garageInput" accept="image/*" style="display: none;">
                <img id="garagePreview" class="preview-image" style="display: none;">
            </div>
            
            <div id="yardPhotoSection" style="display: none;">
                <h3 style="margin-bottom: 15px;">üì∏ Yard Photo</h3>
                <div class="upload-area" id="yardUploadArea" onclick="document.getElementById('yardInput').click()">
                    <div class="upload-icon">üè°</div>
                    <h3>Take Yard Photo</h3>
                    <p style="color: #666; margin-top: 10px;">Show where you want the shed</p>
                </div>
                <input type="file" id="yardInput" accept="image/*" style="display: none;">
                <img id="yardPreview" class="preview-image" style="display: none;">
            </div>
            
            <div class="btn-group">
                <button class="btn btn-secondary" onclick="goToStep(1)">‚Üê Back</button>
                <button class="btn" id="step2Next" disabled onclick="goToStep(3)">Continue to Details</button>
            </div>
        </div>
        
        <!-- STEP 3: Customer Info -->
        <div class="step" id="step3">
            <h2 style="margin-bottom: 25px; color: #2c5aa0;">Step 3: Your Information</h2>
            
            <div class="form-group">
                <label>Customer Name *</label>
                <input type="text" id="customerName" placeholder="Enter your name">
            </div>
            
            <div class="form-group">
                <label>Email Address</label>
                <input type="email" id="customerEmail" placeholder="your@email.com">
            </div>
            
            <div class="form-group">
                <label>Phone Number</label>
                <input type="tel" id="customerPhone" placeholder="(317) 555-1234">
            </div>
            
            <div id="shedOptionsSection" style="display: none;">
                <div class="form-group">
                    <label>Select Shed Size</label>
                    <select id="shedSize">
                        <option value="8x10-4500">8x10 - $4,500</option>
                        <option value="10x12-5500">10x12 - $5,500</option>
                        <option value="12x16-6500" selected>12x16 - $6,500</option>
                        <option value="12x20-7500">12x20 - $7,500</option>
                    </select>
                </div>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-secondary" onclick="goToStep(2)">‚Üê Back</button>
                <button class="btn" onclick="goToStep(4)">Continue to Packages</button>
            </div>
        </div>
        
        <!-- STEP 4: Select Packages -->
        <div class="step" id="step4">
            <h2 style="margin-bottom: 25px; color: #2c5aa0;">Step 4: Choose Your Packages</h2>
            
            <div id="shedPackages" style="display: none;">
                <h3 style="margin-bottom: 15px;">Shed Interior Organization</h3>
                <div class="package-cards">
                    <div class="package-card" onclick="selectPackage('shed', 'basic', 499)">
                        <div class="name">Basic</div>
                        <div class="price">+$499</div>
                        <p style="font-size: 14px; color: #666;">2 walls shelving + hooks</p>
                    </div>
                    
                    <div class="package-card selected" onclick="selectPackage('shed', 'complete', 899)">
                        <div class="name">Complete</div>
                        <div class="price">+$899</div>
                        <p style="font-size: 14px; color: #666;">3 walls + bins + pegboard</p>
                    </div>
                    
                    <div class="package-card" onclick="selectPackage('shed', 'premium', 1499)">
                        <div class="name">Premium</div>
                        <div class="price">+$1,499</div>
                        <p style="font-size: 14px; color: #666;">Complete + workbench + LED</p>
                    </div>
                </div>
            </div>
            
            <div id="garagePackages" style="display: none; margin-top: 25px;">
                <h3 style="margin-bottom: 15px;">Garage Organization</h3>
                <div class="package-cards">
                    <div class="package-card" onclick="selectPackage('garage', 'basic', 1899)">
                        <div class="name">Basic</div>
                        <div class="price">$1,899</div>
                        <p style="font-size: 14px; color: #666;">Wall shelving system</p>
                    </div>
                    
                    <div class="package-card selected" onclick="selectPackage('garage', 'complete', 2799)">
                        <div class="name">Complete</div>
                        <div class="price">$2,799</div>
                        <p style="font-size: 14px; color: #666;">Shelving + overhead + pegboard</p>
                    </div>
                    
                    <div class="package-card" onclick="selectPackage('garage', 'premium', 3499)">
                        <div class="name">Premium</div>
                        <div class="price">$3,499</div>
                        <p style="font-size: 14px; color: #666;">Complete + cabinets + LED</p>
                    </div>
                </div>
            </div>
            
            <div class="alert alert-success" style="margin-top: 25px;">
                <strong>üí° Bundle Bonus:</strong> Save $500 when you choose both garage and shed!
            </div>
            
            <div class="btn-group">
                <button class="btn btn-secondary" onclick="goToStep(3)">‚Üê Back</button>
                <button class="btn" onclick="generateAll()">Generate My Transformation ‚Üí</button>
            </div>
        </div>
        
        <!-- STEP 5: Results -->
        <div class="step" id="step5">
            <div id="loadingState" class="loading">
                <div class="loading-spinner"></div>
                <h3>Creating Your Transformation...</h3>
                <p style="color: #666; margin-top: 12px;">This takes about 30-60 seconds</p>
            </div>
            
            <div id="resultsState" style="display: none;">
                <h2 style="margin-bottom: 25px; color: #2c5aa0;">Your Complete Property Transformation</h2>
                
                <div class="results-grid" id="resultsGrid"></div>
                
                <div class="quote-summary">
                    <h3 style="color: #2c5aa0; margin-bottom: 20px;">Your Custom Quote</h3>
                    <div id="quoteBreakdown"></div>
                </div>
                
                <div class="quote-total">
                    <div>Total Investment</div>
                    <div class="amount" id="quoteTotal">$0</div>
                    <div>or as low as <strong id="quoteMonthly">$0/mo</strong> with financing</div>
                </div>
                
                <button class="btn" style="margin-top: 30px;" onclick="alert('Schedule installation feature coming soon!')">
                    üìÖ Schedule Installation
                </button>
                
                <button class="btn btn-secondary" style="margin-top: 12px;" onclick="location.reload()">
                    Start New Quote
                </button>
            </div>
        </div>
    </div>
    
    <script>
        let state = {
            need: null,
            garageImage: null,
            yardImage: null,
            shedPrice: 6500,
            shedPackage: 'complete',
            shedPackagePrice: 899,
            garagePackage: 'complete',
            garagePackagePrice: 2799
        };
        
        function goToStep(step) {
            document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
            document.getElementById('step' + step).classList.add('active');
            
            document.querySelectorAll('.step-dot').forEach(dot => {
                const dotStep = parseInt(dot.dataset.step);
                dot.classList.remove('active', 'completed');
                if (dotStep === step) dot.classList.add('active');
                else if (dotStep < step) dot.classList.add('completed');
            });
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        function selectNeed(need) {
            state.need = need;
            document.querySelectorAll('.selection-card').forEach(c => c.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            
            const text = {
                garage: 'Garage Organization Only',
                shed: 'Shed with Interior Organization',
                both: 'Complete Solution (Garage + Shed)'
            };
            
            document.getElementById('needSelected').style.display = 'block';
            document.getElementById('needText').textContent = text[need];
            document.getElementById('step1Next').disabled = false;
            
            // Show appropriate sections
            if (need === 'garage' || need === 'both') {
                document.getElementById('garagePhotoSection').style.display = 'block';
                document.getElementById('garagePackages').style.display = 'block';
            }
            if (need === 'shed' || need === 'both') {
                document.getElementById('yardPhotoSection').style.display = 'block';
                document.getElementById('shedOptionsSection').style.display = 'block';
                document.getElementById('shedPackages').style.display = 'block';
            }
        }
        
        // Photo uploads
        document.getElementById('garageInput').addEventListener('change', function(e) {
            handlePhoto(e.target.files[0], 'garage');
        });
        
        document.getElementById('yardInput').addEventListener('change', function(e) {
            handlePhoto(e.target.files[0], 'yard');
        });
        
        function handlePhoto(file, type) {
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    if (type === 'garage') {
                        state.garageImage = e.target.result;
                        document.getElementById('garagePreview').src = e.target.result;
                        document.getElementById('garagePreview').style.display = 'block';
                        document.getElementById('garageUploadArea').style.display = 'none';
                    } else {
                        state.yardImage = e.target.result;
                        document.getElementById('yardPreview').src = e.target.result;
                        document.getElementById('yardPreview').style.display = 'block';
                        document.getElementById('yardUploadArea').style.display = 'none';
                    }
                    checkPhotosComplete();
                };
                reader.readAsDataURL(file);
            }
        }
        
        function checkPhotosComplete() {
            let ready = true;
            if (state.need === 'garage' && !state.garageImage) ready = false;
            if (state.need === 'shed' && !state.yardImage) ready = false;
            if (state.need === 'both' && (!state.garageImage || !state.yardImage)) ready = false;
            document.getElementById('step2Next').disabled = !ready;
        }
        
        document.getElementById('shedSize').addEventListener('change', function() {
            const [size, price] = this.value.split('-');
            state.shedPrice = parseInt(price);
        });
        
        function selectPackage(type, pkg, price) {
            if (type === 'shed') {
                state.shedPackage = pkg;
                state.shedPackagePrice = price;
                document.querySelectorAll('#shedPackages .package-card').forEach(c => c.classList.remove('selected'));
            } else {
                state.garagePackage = pkg;
                state.garagePackagePrice = price;
                document.querySelectorAll('#garagePackages .package-card').forEach(c => c.classList.remove('selected'));
            }
            event.currentTarget.classList.add('selected');
        }
        
        async function generateAll() {
            goToStep(5);
            document.getElementById('loadingState').style.display = 'block';
            document.getElementById('resultsState').style.display = 'none';
            
            const apiKey = localStorage.getItem('openai_api_key');
            if (!apiKey) {
                alert('API key not found. Please refresh and enter your OpenAI API key.');
                return;
            }
            
            try {
                const results = {};
                
                // Generate shed exterior
                if (state.need === 'shed' || state.need === 'both') {
                    results.shedExterior = await generateImage('A professional 12x16 utility shed in a residential backyard, realistic photography');
                    results.shedInterior = await generateImage('Interior of organized shed with heavy-duty shelving, pegboard, storage bins, professional organization');
                }
                
                // Generate garage transformation
                if (state.need === 'garage' || state.need === 'both') {
                    results.garageAfter = await generateImage('Professionally organized garage with wall shelving, overhead racks, pegboard tool organization, clean workbench, everything has a place');
                }
                
                displayResults(results);
                
            } catch (error) {
                alert('Error generating images: ' + error.message);
                console.error(error);
            }
        }
        
        async function generateImage(prompt) {
            const apiKey = localStorage.getItem('openai_api_key');
            
            const response = await fetch('https://api.openai.com/v1/images/generations', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${apiKey}`
                },
                body: JSON.stringify({
                    model: 'dall-e-3',
                    prompt: prompt,
                    n: 1,
                    size: '1024x1024',
                    quality: 'standard'
                })
            });
            
            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.error?.message || 'API request failed');
            }
            
            const data = await response.json();
            return data.data[0].url;
        }
        
        function displayResults(results) {
            document.getElementById('loadingState').style.display = 'none';
            document.getElementById('resultsState').style.display = 'block';
            
            const grid = document.getElementById('resultsGrid');
            grid.innerHTML = '';
            
            // Show results
            if (results.shedExterior) {
                grid.innerHTML += `
                    <div class="result-item">
                        <div class="result-header">üè† Your New Shed</div>
                        <div class="content">
                            <img src="${results.shedExterior}" alt="Shed">
                            <p style="color: #666;">Your 12x16 shed perfectly placed in your yard</p>
                        </div>
                    </div>
                `;
            }
            
            if (results.shedInterior) {
                grid.innerHTML += `
                    <div class="result-item">
                        <div class="result-header">üì¶ Organized Shed Interior</div>
                        <div class="content">
                            <img src="${results.shedInterior}" alt="Interior">
                            <p style="color: #666;">Complete interior organization system</p>
                        </div>
                    </div>
                `;
            }
            
            if (results.garageAfter) {
                grid.innerHTML += `
                    <div class="result-item">
                        <div class="result-header">üöó Transformed Garage</div>
                        <div class="content">
                            <div class="comparison">
                                <div class="comparison-item">
                                    <h4>BEFORE</h4>
                                    <img src="${state.garageImage}" alt="Before">
                                </div>
                                <div class="comparison-item after">
                                    <h4>AFTER</h4>
                                    <img src="${results.garageAfter}" alt="After">
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            // Calculate quote
            let total = 0;
            let breakdown = '';
            
            if (state.need === 'shed' || state.need === 'both') {
                breakdown += `<div class="quote-line"><span>Shed</span><strong>$${state.shedPrice.toLocaleString()}</strong></div>`;
                breakdown += `<div class="quote-line"><span>Interior Package</span><strong>+$${state.shedPackagePrice.toLocaleString()}</strong></div>`;
                total += state.shedPrice + state.shedPackagePrice;
            }
            
            if (state.need === 'garage' || state.need === 'both') {
                breakdown += `<div class="quote-line"><span>Garage Organization</span><strong>$${state.garagePackagePrice.toLocaleString()}</strong></div>`;
                total += state.garagePackagePrice;
            }
            
            if (state.need === 'both') {
                breakdown += `<div class="quote-line savings"><span>Bundle Discount</span><strong>-$500</strong></div>`;
                total -= 500;
            }
            
            breakdown += `<div class="quote-line total"><span>Total</span><strong>$${total.toLocaleString()}</strong></div>`;
            
            document.getElementById('quoteBreakdown').innerHTML = breakdown;
            document.getElementById('quoteTotal').textContent = '$' + total.toLocaleString();
            document.getElementById('quoteMonthly').textContent = '$' + Math.ceil(total / 30) + '/mo';
        }
    </script>
</body>
</html>
